{
  "prompt": "Schematic of the iterative process to compute self-consistent solutions of the \\textsc{SIESTA}-BdG secular equation. During the update step within the \\textsc{SIESTA}-BdG SCF loop the density or the Hamiltonian is mixed.",
  "response": "To create the LaTeX code for the schematic diagram you provided, you can use the `tikz` package along with the `tikzlibrary` for flowcharts. Below is an example of how you might write the LaTeX code for this diagram:\n\n```latex\n\\documentclass{article}\n\\usepackage{tikz}\n\\usetikzlibrary{arrows.meta,\n                chains,\n                positioning,\n                shapes.geometric}\n\n\\begin{document}\n    \\begin{figure}[ht]\n\\centering\n    \\begin{tikzpicture}[\nnode distance = 8mm and 12mm,\n  start chain = A going below,\n   arr/.style = {very thick, draw=orange!50},\n   box/.style = {draw, rounded corners, fill=blue!10,\n                 minimum width=34mm, minimum height=7mm,\n                 inner sep=2mm, outer sep=0mm, on chain=A},\n   dot/.style = {circle, draw, fill=black, minimum size=2pt,\n                 inner sep=0pt, outer sep=0pt, node contents={}},\n   io/.style = {ellipse, draw, fill=blue!10,\n                minimum width=24mm, minimum height=7mm,\n                inner sep=2mm, outer sep=0mm, on chain=A},\nevery edge/.append style = {draw, -Stealth, semithick}\n                        ]\n\\node (n1) [io] {START};\n\\node (n2) [box] {DFT-SCF: Find self-consistent solution for the normal-state electronic density $\\rho_{\\rm s}$};\n\\node (n3) [box] {Construct $\\Delta_{\\rm s}^{\\rm SCF}[\\rho_{\\rm s}]$};\n\\node (n4) [dot];\n%\n\\node (n5) [box] {Input $\\Delta_{\\rm s}$};\n\\node (n6) [box] {non-SCF-BdG method};\n\\node (n7) [dot];\n%\n\\node (n8) [box] {Solve eigenvalue problem:\n    \\begin{minipage}{0.9\\linewidth}\n        \\begin{equation*}\n            \\left(\\begin{array}{cc}\n                \\frac{\\delta\\Delta_{\\rm s}^{\\rm BdG}}{\\delta\\Delta_{\\rm s}} & \\Delta_{\\rm s} \\\\\n                \\Delta_{\\rm s}^\\dagger & \\alpha^{\\rm BdG}\\rho_{\\rm s}\n            \\end{array}\\right)\n            \\left(\\begin{array}{c}\n                \\Delta_{\\rm s} \\\\\n                \\gamma_{\\rm s}\n            \\end{array}\\right)\n            =\n            \\left(\\begin{array}{cc}\n                \\mathbf{S}_{\\rm s} & 0 \\\\\n                0 & \\mathbf{S}_{\\rm s}\n            \\end{array}\\right)\n            \\left(\\begin{array}{c}\n                \\Delta_{\\rm s} \\\\\n                \\gamma_{\\rm s}\n            \\end{array}\\right)\n        \\end{equation*}\n    \\end{minipage}};\n\\node (n9) [box] {Construct $\\rho_{\\rm s}$ and $\\gamma$ matrices from $\\left(\\begin{array}{c}\n                \\Delta_{\\rm s} \\\\\n                \\gamma_{\\rm s}\n            \\end{array}\\right)$};\n%\n\\node (n10) [io] {Final-$\\Delta$};\n\\node (n11) [box] {Final-$\\Delta$ or full SCF-BdG?};\n\\node (n12) [dot];\n%\n\\node (n13) [box] {Construct $\\Delta_{\\rm s}^{\\rm BdG}$};\n\\node (n14) [dot];\n%\n\\node (n15) [box] {Self-consistent $\\rho_{\\rm s}$ and $\\Delta_{\\rm s}^{\\rm BdG}$?};\n\\node (n16) [dot];\n%\n\\node (n17) [box] {Charge converged?};\n\\node (n18) [dot];\n%\n\\node (n19) [io, right=of n17] {V};\n%\n\\draw[arr]   (n1) -- (n2);\n\\draw[arr]   (n2) -- (n3);\n\\draw[arr]   (n3) -- (n4);\n\\draw[arr]   (n4) -- (n5);\n\\draw[arr]   (n5) -- (n6);\n\\draw[arr]   (n6) -- (n7);\n\\draw[arr]   (n7) -- (n8);\n\\draw[arr]   (n8) -- (n9);\n\\draw[arr]   (n9) -- (n10);\n\\draw[arr]   (n10) -- (n11);\n\\draw[arr]   (n11) -- (n12);\n\\draw[arr]   (n12) -- (n13);\n\\draw[arr]   (n13) -- (n14);\n\\draw[arr]   (n14) -- (n15);\n\\draw[arr]   (n15) -- (n16);\n\\draw[arr]   (n16) -- (n17);\n\\draw[arr]   (n17) -- (n18);\n\\draw[arr]   (n18) -- (n19);\n%\n\\draw[arr]   (n11.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n1",
  "latex_code": "To create the LaTeX code for the schematic diagram you provided, you can use the `tikz` package along with the `tikzlibrary` for flowcharts. Below is an example of how you might write the LaTeX code for this diagram:\n\n```latex\n\\documentclass{article}\n\\usepackage{tikz}\n\\usetikzlibrary{arrows.meta,\n                chains,\n                positioning,\n                shapes.geometric}\n\n\\begin{document}\n    \\begin{figure}[ht]\n\\centering\n    \\begin{tikzpicture}[\nnode distance = 8mm and 12mm,\n  start chain = A going below,\n   arr/.style = {very thick, draw=orange!50},\n   box/.style = {draw, rounded corners, fill=blue!10,\n                 minimum width=34mm, minimum height=7mm,\n                 inner sep=2mm, outer sep=0mm, on chain=A},\n   dot/.style = {circle, draw, fill=black, minimum size=2pt,\n                 inner sep=0pt, outer sep=0pt, node contents={}},\n   io/.style = {ellipse, draw, fill=blue!10,\n                minimum width=24mm, minimum height=7mm,\n                inner sep=2mm, outer sep=0mm, on chain=A},\nevery edge/.append style = {draw, -Stealth, semithick}\n                        ]\n\\node (n1) [io] {START};\n\\node (n2) [box] {DFT-SCF: Find self-consistent solution for the normal-state electronic density $\\rho_{\\rm s}$};\n\\node (n3) [box] {Construct $\\Delta_{\\rm s}^{\\rm SCF}[\\rho_{\\rm s}]$};\n\\node (n4) [dot];\n%\n\\node (n5) [box] {Input $\\Delta_{\\rm s}$};\n\\node (n6) [box] {non-SCF-BdG method};\n\\node (n7) [dot];\n%\n\\node (n8) [box] {Solve eigenvalue problem:\n    \\begin{minipage}{0.9\\linewidth}\n        \\begin{equation*}\n            \\left(\\begin{array}{cc}\n                \\frac{\\delta\\Delta_{\\rm s}^{\\rm BdG}}{\\delta\\Delta_{\\rm s}} & \\Delta_{\\rm s} \\\\\n                \\Delta_{\\rm s}^\\dagger & \\alpha^{\\rm BdG}\\rho_{\\rm s}\n            \\end{array}\\right)\n            \\left(\\begin{array}{c}\n                \\Delta_{\\rm s} \\\\\n                \\gamma_{\\rm s}\n            \\end{array}\\right)\n            =\n            \\left(\\begin{array}{cc}\n                \\mathbf{S}_{\\rm s} & 0 \\\\\n                0 & \\mathbf{S}_{\\rm s}\n            \\end{array}\\right)\n            \\left(\\begin{array}{c}\n                \\Delta_{\\rm s} \\\\\n                \\gamma_{\\rm s}\n            \\end{array}\\right)\n        \\end{equation*}\n    \\end{minipage}};\n\\node (n9) [box] {Construct $\\rho_{\\rm s}$ and $\\gamma$ matrices from $\\left(\\begin{array}{c}\n                \\Delta_{\\rm s} \\\\\n                \\gamma_{\\rm s}\n            \\end{array}\\right)$};\n%\n\\node (n10) [io] {Final-$\\Delta$};\n\\node (n11) [box] {Final-$\\Delta$ or full SCF-BdG?};\n\\node (n12) [dot];\n%\n\\node (n13) [box] {Construct $\\Delta_{\\rm s}^{\\rm BdG}$};\n\\node (n14) [dot];\n%\n\\node (n15) [box] {Self-consistent $\\rho_{\\rm s}$ and $\\Delta_{\\rm s}^{\\rm BdG}$?};\n\\node (n16) [dot];\n%\n\\node (n17) [box] {Charge converged?};\n\\node (n18) [dot];\n%\n\\node (n19) [io, right=of n17] {V};\n%\n\\draw[arr]   (n1) -- (n2);\n\\draw[arr]   (n2) -- (n3);\n\\draw[arr]   (n3) -- (n4);\n\\draw[arr]   (n4) -- (n5);\n\\draw[arr]   (n5) -- (n6);\n\\draw[arr]   (n6) -- (n7);\n\\draw[arr]   (n7) -- (n8);\n\\draw[arr]   (n8) -- (n9);\n\\draw[arr]   (n9) -- (n10);\n\\draw[arr]   (n10) -- (n11);\n\\draw[arr]   (n11) -- (n12);\n\\draw[arr]   (n12) -- (n13);\n\\draw[arr]   (n13) -- (n14);\n\\draw[arr]   (n14) -- (n15);\n\\draw[arr]   (n15) -- (n16);\n\\draw[arr]   (n16) -- (n17);\n\\draw[arr]   (n17) -- (n18);\n\\draw[arr]   (n18) -- (n19);\n%\n\\draw[arr]   (n11.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n17.east) -- ++ (1,0) |- (n19);\n\\draw[arr]   (n1",
  "ground_truth": "\\documentclass{article}\n\\usepackage[utf8]{inputenc}\n\\usepackage[usenames,dvipsnames]{xcolor}\n\\usepackage{tikz}\n\\usetikzlibrary{automata, arrows.meta, calc, fit, positioning,shapes}\n\\usepackage{amsmath,amssymb}\n\n\\begin{document}\n\n\\begin{tikzpicture}[font=\\small,align=center,node distance=0.75cm]\n    \\definecolor{borderColour}{HTML}{2f528f}\n    \\definecolor{myBlue}{HTML}{4472c4}\n    \\definecolor{myOrange}{HTML}{ed7d31}\n    \\definecolor{myGreen}{HTML}{92d050}\n\n    \\tikzset{box/.style={\n            draw=borderColour, very thick,\n            minimum width=2.5cm,\n            inner sep=2mm,\n            align=center,\n            minimum height=1cm}}\n    \\tikzset{input/.style={\n            trapezium,\n            trapezium left angle = 65,\n            trapezium right angle = 115,\n            trapezium stretches}}\n    \\tikzset{choice/.style={\n            diamond,\n            aspect=2.5}}\n    \\tikzset{connect/.style={->, >=latex, ultra thick, borderColour}}\n\n    % Normal part\n    \\node[box,rounded rectangle] (START) at (0, 0) {START};\n    \\node[box,input,below=of START] (Rho0) {DFT SCF: Find self-consistent solution for the \\\\\n        normal-state electronic density\n        $\\rho_0$};  \n\n    \\node[box,below=1cm of Rho0] (HofRho) {Construct $h^{\\mathrm{KS}}_{\\mu\\nu}[\\rho_0]$};\n    \\node[box,choice,below=1.5cm of HofRho ] (Oneshot) {non SCF-BdG\\\\ method?};          \n\n    \\node[box,below=1.2cm of Oneshot] (Diag) {Solve eigenvalue problem: \\\\\n        $\\left(\\begin{array}{cc}\n            h^{KS}_{\\mu\\nu} & \\Delta_{\\mu\\nu}\\\\\n            -\\Delta^*_{\\mu\\nu} & -h^{KS}*_{\\mu\\nu}\n        \\end{array}\\right)\n        \\left(\\begin{array}{c}\n            u_{\\nu}\\\\\n            v_{\\nu}\n        \\end{array} \\right)\n        = \\varepsilon \\left(\\begin{array}{cc}\n            \\mathbf{S}_{\\mu\\nu} & 0\\\\\n            0 & \\mathbf{S}_{\\mu\\nu}\n        \\end{array} \\right)\n        \\left(\\begin{array}{c}\n            u_{\\nu}\\\\\n            v_{\\nu}\n        \\end{array} \\right)$};\n    \\node[box,below=of Diag] (CalcRhoChiFixD0) {Construct $\\rho$ and $\\chi$ matrices\n        from $\\left(\\begin{array}{c} u_{\\nu}\\\\ v_{\\nu}\\end{array} \\right)$};            \n      \\node[box,choice,below=of CalcRhoChiFixD0 ] (FixDorFixL) {Fixed-$\\Delta$ or \\\\ full SCF-BdG?};\n    % % Fixed-Delta  \n    \\node[box,rounded rectangle,left=2cm of FixDorFixL] (FixD) {Fixed-$\\Delta$};\n    \\node[box,below=1.2cm of FixD] (CalcHk) {Construct $h^{KS}_{\\mu\\nu}$};\n    \\node[box,choice,below=of CalcHk ] (SCFixD) {Self-consistent\\\\\n    $\\rho$ and $h^{KS}_{\\mu\\nu}$?};        \n    % % Fixed-Lambda\n    \\node[box,rounded rectangle,right=2cm of FixDorFixL] (FixL) {full SCF-BdG};\n    \\node[box,below=1.2cm of FixL] (CalchDFixL) {Construct $h^{KS}_{\\mu\\nu}$ and $\\Delta_{\\mu\\nu}$};\n    \\node[box,choice,below=of CalchDFixL] (SCFixL) {Self-consistent\\\\\n    $\\rho$, $h^{KS}_{\\mu\\nu}$, $\\chi$, $\\Delta$?}; \n    % %Charge\n    \\node[box,choice,below=5cm of FixDorFixL] (Charge) {Charge conserved?}; \n    \\node[box,choice,below=of Charge] (Fermi) {Update Fermi level?}; \n    %Charge        \n    %Postprocessing\n    \\node[box,below=1.5cm of Fermi] (Postprocess) {Solve eigenvalue problem: \\\\\n        $\\left(\\begin{array}{cc}\n            h^{KS}_{\\mu\\nu} & \\Delta_{\\mu\\nu}\\\\\n            -\\Delta^*_{\\mu\\nu} & -h^{KS}*_{\\mu\\nu}\n        \\end{array}\\right)\n        \\left(\\begin{array}{c}\n            u_{\\nu}\\\\\n            v_{\\nu}\n        \\end{array} \\right)\n        = \\varepsilon \\left(\\begin{array}{cc}\n            \\mathbf{S}_{\\mu\\nu} & 0\\\\\n            0 & \\mathbf{S}_{\\mu\\nu}\n        \\end{array} \\right)\n        \\left(\\begin{array}{c}\n            u_{\\nu}\\\\\n            v_{\\nu}\n        \\end{array} \\right)$ \\\\\n        for bands, PDOS, $\\chi$, etc.};        \n\n    % %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n    \\draw[connect] (START) -- (Rho0);\n    \\draw[connect] (Rho0) -- (HofRho);\n    \\draw[connect] (HofRho) -- (Oneshot) node[pos=0.5,fill=white,inner sep=1mm]{Input $\\Delta_{\\mu\\nu}$};\n    \\draw[connect] (Oneshot) -- ++(13cm,0)   node[pos=0.5,fill=white,inner sep=1mm]{Yes}  |-node[pos=0.25,fill=white,inner sep=1mm]{\\textit{skip} \\\\ \\textsc{SIESTA}-BdG\\\\\\textit{SCF loop}} (Postprocess);\n    \\draw[connect] (Oneshot) -- (Diag) node[pos=0.35,fill=white,inner sep=1mm]{No};\n    \\node (SCF) [box,draw=myOrange,rounded corners,inner sep=11mm,fit = (Diag) (SCFixD) (SCFixL)(Fermi),label={[anchor=center,fill=white,font=\\large,text=myOrange]135:{\\textbf{\\textsc{SIESTA}-BdG SCF loop}}},\n    minimum width=21.3cm] {};        \n    \\draw[connect] (Diag) -- (CalcRhoChiFixD0);   \n    \\draw[connect] (CalcRhoChiFixD0) -- (FixDorFixL);\n    \\draw[connect] (FixDorFixL) -- (FixD);\n    \\draw[connect] (FixDorFixL) -- (FixL);\n    \\draw[connect] (FixD) -- (CalcHk);\n    \\draw[connect] (CalcHk)-- (SCFixD);\n    \\draw[connect] (SCFixD) -- (Charge) node[pos=0.35,fill=white,inner sep=1mm]{Yes};\n    \\draw[connect] (SCFixD) -- ++ (-3.91cm,0) node[pos=0.5,fill=white,inner sep=1mm]{No} |- (Diag);\n    \\draw[connect] (FixL) -- (CalchDFixL)node[pos=0.5,fill=white,inner sep=1mm]{Input $\\lambda$};\n    \\draw[connect] (CalchDFixL) -- (SCFixL);\n    \\draw[connect] (SCFixL) -- (Charge)\n    node[pos=0.35,fill=white,inner sep=1mm]{Yes};\n    \\draw[connect] (SCFixL) -- ++ (4.275cm,0) node[pos=0.5,fill=white,inner sep=1mm]{No} |- (Diag);\n    \\draw[connect] (Charge) -- (Fermi)\n    node[pos=0.35,fill=white,inner sep=1mm]{No};\n    \\draw[connect] (Charge) -- ++(7cm,0) node[pos=0.5,fill=white,inner sep=1mm]{Yes} |- (Postprocess);\n    \\draw[connect] (Fermi) -- ++(-10.250cm,0) node[pos=0.5,fill=white,inner sep=1mm]{Yes} |- (Diag);\n    \\draw[connect] (Fermi) -- (Postprocess) node[pos=0.5,fill=white,inner sep=1mm]{No};\n    % %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n\\end{tikzpicture}\n\n\\end{document}"
}