{
  "prompt": "Illustration of the proof sketch of Theorem~\\ref{th:main}. On the left, the $h$-backward substructure from~$p$ that is detailed in Section~\\ref{sec:backward}. It has size $\\Theta(\\sqrt{n})$ and contains $\\Theta(\\sqrt{n})$ extremal leaves (i.e. leaves in its last level $h$) to be valid. In the center, the forward tree from $r$, described in Section~\\ref{sec:forward}; it is a breadth-first traversal that is valid if it hits an extremal leaf of the backward substructure before $\\sqrt{n}$ states are examined. On the right the $b$-threads introduced in Section~\\ref{sec:b-cycles}, obtained by reading $b$'s from the $p_i$'s; they are valid if they are made of previously unseen states and are pairwise disjoint until they cycle back on themselves, forming a $b$-cycle of length in $[\\![\\sqrt{n},2\\sqrt{n}\\,]\\!]$.",
  "response": "To generate LaTeX code for the image and caption provided, you can use the `tikz` package along with some additional packages like `pgfplots` for drawing the graph and `amsmath` for mathematical expressions. Below is a sample LaTeX code that creates a similar diagram:\n\n```latex\n\\documentclass{article}\n\\usepackage{amsmath}\n\\usepackage{tikz}\n\\usetikzlibrary{arrows.meta, decorations.pathmorphing, positioning, quotes}\n\n\\begin{document}\n\n\\begin{figure}[h]\n    \\centering\n    \\begin{tikzpicture}[node distance=1cm, auto,\n        state/.style={circle, draw, minimum size=0.5cm},\n        leaf/.style={circle, fill, inner sep=1pt},\n        arrow/.style={-{Stealth[scale=1.5]}, thick},\n        dashed arrow/.style={-{Stealth[scale=1.5]}, dashed, thick},\n        green arrow/.style={-{Stealth[scale=1.5]}, green, thick},\n        blue arrow/.style={-{Stealth[scale=1.5]}, blue, thick},\n        red arrow/.style={-{Stealth[scale=1.5]}, red, thick},\n        dotted arrow/.style={-{Stealth[scale=1.5]}, dotted, thick},\n        ]\n\n        % Nodes\n        \\node[state] (p) {$p$};\n        \\node[state, below=of p] (L1) {$L_1$};\n        \\node[state, below=of L1] (L2) {$L_2$};\n        \\node[state, below=of L2] (dots) {$\\vdots$};\n        \\node[state, below=of dots] (Lh) {$[L_h]\\in\\Theta(\\sqrt{n})$};\n        \\node[state, right=3cm of p] (q) {$q$};\n        \\node[state, right=3cm of q] (p1) {$p_1$};\n        \\node[state, right=3cm of p1] (p2) {$p_2$};\n        \\node[state, below=of p1] (w1) {};\n        \\node[state, below=of w1] (w2) {};\n        \\node[state, below=of w2] (w3) {};\n        \\node[state, below=of w3] (w4) {};\n        \\node[state, below=of w4] (w5) {};\n        \\node[state, below=of w5] (w6) {};\n        \\node[state, below=of w6] (w7) {};\n        \\node[state, below=of w7] (w8) {};\n        \\node[state, below=of w8] (w9) {};\n        \\node[state, below=of w9] (w10) {};\n        \\node[state, below=of w10] (w11) {};\n        \\node[state, below=of w11] (w12) {};\n        \\node[state, below=of w12] (w13) {};\n        \\node[state, below=of w13] (w14) {};\n        \\node[state, below=of w14] (w15) {};\n        \\node[state, below=of w15] (w16) {};\n        \\node[state, below=of w16] (w17) {};\n        \\node[state, below=of w17] (w18) {};\n        \\node[state, below=of w18] (w19) {};\n        \\node[state, below=of w19] (w20) {};\n        \\node[state, below=of w20] (w21) {};\n        \\node[state, below=of w21] (w22) {};\n        \\node[state, below=of w22] (w23) {};\n        \\node[state, below=of w23] (w24) {};\n        \\node[state, below=of w24] (w25) {};\n        \\node[state, below=of w25] (w26) {};\n        \\node[state, below=of w26] (w27) {};\n        \\node[state, below=of w27] (w28) {};\n        \\node[state, below=of w28] (w29) {};\n        \\node[state, below=of w29] (w30) {};\n        \\node[state, below=of w30] (w31) {};\n        \\node[state, below=of w31] (w32) {};\n        \\node[state, below=of w32] (w33) {};\n        \\node[state, below=of w33] (w34) {};\n        \\node[state, below=of w34] (w35) {};\n        \\node[state, below=of w35] (w36) {};\n        \\node[state, below=of w36] (w37) {};\n        \\node[state, below=of w37] (w38) {};\n        \\node[state, below=of w38] (w39) {};\n        \\node[state, below=of w39] (w40) {};\n        \\node[state, below=of w40] (w41) {};\n        \\node[state, below=of w41] (w42) {};\n        \\node[state, below=of w42] (w43) {};\n        \\node[state, below=of w43] (w44) {};\n        \\node[state, below=of w44] (w45) {};\n        \\node[state, below=of w45] (w46) {};\n        \\node[state, below=of w46] (w47) {};\n        \\node[state, below=of w47] (w48) {};\n        \\node[state, below=of w48] (w49) {};\n        \\node[state, below=of w49] (w50) {};\n        \\node[state, below=of w50] (w51) {};\n        \\node[state, below=of w51] (w52) {};\n        \\node[state, below=of w52] (w53) {};\n        \\node[state, below=of w53] (w54) {};\n        \\node[state, below=of w54] (w55) {};\n        \\node[state, below=of w55] (w56) {};\n        \\node[state, below=of w56] (w57) {};\n        \\node[state, below=of w57] (w58) {};\n        \\node[state, below=of w58] (w59) {};\n        \\node[state, below=of w59] (w60) {};\n        \\node[state, below=of w60] (w61) {};\n        \\node[state, below=of w61] (w62) {};\n        \\node[state, below=of w62] (w63) {};\n        \\node[state, below=of w63] (w64) {};\n        \\node[state, below=of w64] (w65) {};\n        \\node[state, below=of w65] (w66) {};\n        \\node[state, below=of w66] (w67) {};\n        \\node[state, below=of w67] (w68) {};\n        \\node[state, below=of w68] (w69) {};\n        \\node[state, below=of w69] (w70) {};\n        \\node[state, below=of w70] (w71) {};\n        \\node[state, below=of w71] (w72) {};\n        \\node[state, below=of w72] (w73) {};\n        \\node[state, below=of w73] (w74) {};\n        \\node[state, below=of w74] (w75) {};\n        \\node[state, below=of w75] (w76) {};\n        \\node[state, below=of w76] (w77) {};\n        \\node[state, below=of w77] (w78) {};\n        \\node[state, below=of w78] (w79) {};\n        \\node[state, below=of w79] (w80) {};\n        \\node[state, below=of w80] (w81) {};\n        \\node[state, below=of w81] (w82) {};\n        \\node[state, below=of w82] (w83) {};\n        \\node[state, below=of w83] (w84) {};\n        \\node[state, below=of w84] (w85) {};\n        \\node[state, below=of w85] (w86) {};\n        \\node[state, below=of w86] (w87) {};\n        \\node[state, below=of w87] (w88) {};\n        \\node[state, below=of w88] (w89) {};\n        \\node[state, below=of w89] (w90) {};\n        \\node[state, below=of w90] (w91) {};\n        \\node[state, below=of w91] (w92) {};\n        \\node[state, below=of w92] (w93) {};\n        \\node[state, below=of w93] (w94) {};\n        \\node[state, below=of w94] (w95) {};\n        \\node[state, below=of w95] (w96) {};\n        \\node[state, below=of w96] (w97) {};\n        \\node[state, below=of w97] (w98) {};\n        \\node[state, below=of w98] (w99) {};\n        \\node[state, below=of w99] (w100) {};\n        \\node[state, below=of w100] (w101) {};\n        \\node[state, below=of w101] (w102) {};\n        \\node[state, below=of w102] (w103) {};\n        \\node[state, below=of w103] (w104) {};\n        \\node[state, below=of w104] (w105) {};\n        \\node[state, below=of w105] (w106) {};\n        \\node[state, below=of w106] (w107) {};\n        \\node[state, below=of w107] (w108) {};\n        \\node[state, below=of w108] (w109) {};\n        \\node[state, below=of w109] (w110) {};\n        \\node[state, below=of w110] (w111) {};\n        \\node[state, below=of w111] (w112) {};\n        \\node[state, below=of w112] (w113) {};\n        \\node[state, below=of w113] (w114) {};\n        \\node[state, below=of w114] (w115) {};\n        \\node[state, below=of w115] (w116) {};\n        \\node[state, below=of w116] (w117) {};\n        \\node[state, below=of w117] (w118) {};\n        \\node[state, below=of w118] (w119) {};\n        \\node[state, below=of w119] (w120) {};\n        \\node[state, below=of w120] (w121) {};\n        \\node[state, below=of w121] (w122) {};\n        \\node[state, below=of w122] (w123) {};\n        \\node[state, below=of w123] (w124) {};\n        \\node[state, below=of w124] (w125) {};\n        \\node[state, below=of w125] (w126) {};\n        \\node[state, below=of w126] (w127) {};\n        \\node[state, below=of w127] (w128) {};\n        \\node[state, below=of w128] (w129) {};\n        \\node[state, below=of w129] (w130) {};\n        \\node[state, below=of w130] (w131) {};\n        \\node[state, below=of w131] (w132) {};\n        \\node[state, below=of w132] (w133) {};\n        \\node[state, below=of w133] (w134) {};\n        \\node[state, below=of w134] (w135) {};\n        \\node[state, below=of w135] (w136) {};\n        \\node[state, below=of w136] (w137) {};\n        \\node[state, below=of w137] (w138) {};\n        \\node[state, below=of w138] (w139) {};\n        \\node[state, below=of w139] (w140) {};\n        \\node[state, below=of w140] (w141) {};\n        \\node[state, below=of w141] (w142) {};\n        \\node[state, below=of w142] (w143) {};\n        \\node[state, below=of w143] (w144) {};\n        \\node[state, below=of w144] (w145) {};\n        \\node[state, below=of w145] (w146) {};\n        \\node[state, below=of w146] (w147) {};\n        \\node[state, below=of w147] (w148) {};\n        \\node[state, below=of w148] (w149) {};\n        \\node[state, below=of w149] (w150) {};\n        \\node[state, below=of w150] (w151) {};\n        \\node[state, below=of w151] (w152) {};\n        \\node[state, below=of w152] (w153) {};\n        \\node[state, below=of w153] (w154) {};\n        \\node[state, below=of w154] (w155) {};\n        \\node[state, below=of w155] (w156) {};\n        \\node[state, below=of w156] (w157) {};\n        \\node[state, below=of w157] (w158) {};\n        \\node[state, below=of w158] (w159) {};\n        \\node[state, below=of w159] (w160) {};\n        \\node[state, below=of w160] (w161) {};\n        \\node[state, below=of w161] (w162) {};\n        \\node[state, below=of w162] (w163) {};\n        \\node[state, below=of w163] (w164) {};\n        \\node[state, below=of w164] (w165) {};\n        \\node[state, below=of w165] (w166) {};\n        \\node[state, below=of w166] (w167) {};\n        \\node[state, below=of w167] (w168) {};\n        \\node[state, below=of w168] (w169) {};\n        \\node[state, below=of w169] (w170) {};\n        \\node[state, below=of w170] (w171) {};\n        \\node[state, below=of w171] (w172) {};\n        \\node[state, below=of w172] (w173) {};\n        \\node[state, below=of w173] (w174) {};\n        \\node[state, below=of w174] (w175) {};\n        \\node[state, below=of w175] (w176) {};\n        \\node[state, below=of w176] (w177) {};\n        \\node[state, below=of w177] (w178) {};\n        \\node[state, below=of w178] (w179) {};\n        \\node[state, below=of w179] (w180) {};\n        \\node[state, below=of w180] (w181) {};\n        \\node[state, below=of w181] (w182) {};\n        \\node[state, below=of w182] (w183) {};\n        \\node[state, below=of w183] (w184) {};\n        \\node[state, below=of w184] (w185) {};\n        \\node[state, below=of w185] (w186) {};\n        \\node[state, below=of w186] (w187) {};\n        \\node[state, below=of w187] (w188) {};\n        \\node[state, below=of w188] (w189) {};\n        \\node[state, below=of w189] (w190) {};\n        \\node[state, below=of w190] (w191) {};\n        \\node[state, below=of w191] (w192) {};\n        \\node[state, below=of w192] (w193",
  "latex_code": "To generate LaTeX code for the image and caption provided, you can use the `tikz` package along with some additional packages like `pgfplots` for drawing the graph and `amsmath` for mathematical expressions. Below is a sample LaTeX code that creates a similar diagram:\n\n```latex\n\\documentclass{article}\n\\usepackage{amsmath}\n\\usepackage{tikz}\n\\usetikzlibrary{arrows.meta, decorations.pathmorphing, positioning, quotes}\n\n\\begin{document}\n\n\\begin{figure}[h]\n    \\centering\n    \\begin{tikzpicture}[node distance=1cm, auto,\n        state/.style={circle, draw, minimum size=0.5cm},\n        leaf/.style={circle, fill, inner sep=1pt},\n        arrow/.style={-{Stealth[scale=1.5]}, thick},\n        dashed arrow/.style={-{Stealth[scale=1.5]}, dashed, thick},\n        green arrow/.style={-{Stealth[scale=1.5]}, green, thick},\n        blue arrow/.style={-{Stealth[scale=1.5]}, blue, thick},\n        red arrow/.style={-{Stealth[scale=1.5]}, red, thick},\n        dotted arrow/.style={-{Stealth[scale=1.5]}, dotted, thick},\n        ]\n\n        % Nodes\n        \\node[state] (p) {$p$};\n        \\node[state, below=of p] (L1) {$L_1$};\n        \\node[state, below=of L1] (L2) {$L_2$};\n        \\node[state, below=of L2] (dots) {$\\vdots$};\n        \\node[state, below=of dots] (Lh) {$[L_h]\\in\\Theta(\\sqrt{n})$};\n        \\node[state, right=3cm of p] (q) {$q$};\n        \\node[state, right=3cm of q] (p1) {$p_1$};\n        \\node[state, right=3cm of p1] (p2) {$p_2$};\n        \\node[state, below=of p1] (w1) {};\n        \\node[state, below=of w1] (w2) {};\n        \\node[state, below=of w2] (w3) {};\n        \\node[state, below=of w3] (w4) {};\n        \\node[state, below=of w4] (w5) {};\n        \\node[state, below=of w5] (w6) {};\n        \\node[state, below=of w6] (w7) {};\n        \\node[state, below=of w7] (w8) {};\n        \\node[state, below=of w8] (w9) {};\n        \\node[state, below=of w9] (w10) {};\n        \\node[state, below=of w10] (w11) {};\n        \\node[state, below=of w11] (w12) {};\n        \\node[state, below=of w12] (w13) {};\n        \\node[state, below=of w13] (w14) {};\n        \\node[state, below=of w14] (w15) {};\n        \\node[state, below=of w15] (w16) {};\n        \\node[state, below=of w16] (w17) {};\n        \\node[state, below=of w17] (w18) {};\n        \\node[state, below=of w18] (w19) {};\n        \\node[state, below=of w19] (w20) {};\n        \\node[state, below=of w20] (w21) {};\n        \\node[state, below=of w21] (w22) {};\n        \\node[state, below=of w22] (w23) {};\n        \\node[state, below=of w23] (w24) {};\n        \\node[state, below=of w24] (w25) {};\n        \\node[state, below=of w25] (w26) {};\n        \\node[state, below=of w26] (w27) {};\n        \\node[state, below=of w27] (w28) {};\n        \\node[state, below=of w28] (w29) {};\n        \\node[state, below=of w29] (w30) {};\n        \\node[state, below=of w30] (w31) {};\n        \\node[state, below=of w31] (w32) {};\n        \\node[state, below=of w32] (w33) {};\n        \\node[state, below=of w33] (w34) {};\n        \\node[state, below=of w34] (w35) {};\n        \\node[state, below=of w35] (w36) {};\n        \\node[state, below=of w36] (w37) {};\n        \\node[state, below=of w37] (w38) {};\n        \\node[state, below=of w38] (w39) {};\n        \\node[state, below=of w39] (w40) {};\n        \\node[state, below=of w40] (w41) {};\n        \\node[state, below=of w41] (w42) {};\n        \\node[state, below=of w42] (w43) {};\n        \\node[state, below=of w43] (w44) {};\n        \\node[state, below=of w44] (w45) {};\n        \\node[state, below=of w45] (w46) {};\n        \\node[state, below=of w46] (w47) {};\n        \\node[state, below=of w47] (w48) {};\n        \\node[state, below=of w48] (w49) {};\n        \\node[state, below=of w49] (w50) {};\n        \\node[state, below=of w50] (w51) {};\n        \\node[state, below=of w51] (w52) {};\n        \\node[state, below=of w52] (w53) {};\n        \\node[state, below=of w53] (w54) {};\n        \\node[state, below=of w54] (w55) {};\n        \\node[state, below=of w55] (w56) {};\n        \\node[state, below=of w56] (w57) {};\n        \\node[state, below=of w57] (w58) {};\n        \\node[state, below=of w58] (w59) {};\n        \\node[state, below=of w59] (w60) {};\n        \\node[state, below=of w60] (w61) {};\n        \\node[state, below=of w61] (w62) {};\n        \\node[state, below=of w62] (w63) {};\n        \\node[state, below=of w63] (w64) {};\n        \\node[state, below=of w64] (w65) {};\n        \\node[state, below=of w65] (w66) {};\n        \\node[state, below=of w66] (w67) {};\n        \\node[state, below=of w67] (w68) {};\n        \\node[state, below=of w68] (w69) {};\n        \\node[state, below=of w69] (w70) {};\n        \\node[state, below=of w70] (w71) {};\n        \\node[state, below=of w71] (w72) {};\n        \\node[state, below=of w72] (w73) {};\n        \\node[state, below=of w73] (w74) {};\n        \\node[state, below=of w74] (w75) {};\n        \\node[state, below=of w75] (w76) {};\n        \\node[state, below=of w76] (w77) {};\n        \\node[state, below=of w77] (w78) {};\n        \\node[state, below=of w78] (w79) {};\n        \\node[state, below=of w79] (w80) {};\n        \\node[state, below=of w80] (w81) {};\n        \\node[state, below=of w81] (w82) {};\n        \\node[state, below=of w82] (w83) {};\n        \\node[state, below=of w83] (w84) {};\n        \\node[state, below=of w84] (w85) {};\n        \\node[state, below=of w85] (w86) {};\n        \\node[state, below=of w86] (w87) {};\n        \\node[state, below=of w87] (w88) {};\n        \\node[state, below=of w88] (w89) {};\n        \\node[state, below=of w89] (w90) {};\n        \\node[state, below=of w90] (w91) {};\n        \\node[state, below=of w91] (w92) {};\n        \\node[state, below=of w92] (w93) {};\n        \\node[state, below=of w93] (w94) {};\n        \\node[state, below=of w94] (w95) {};\n        \\node[state, below=of w95] (w96) {};\n        \\node[state, below=of w96] (w97) {};\n        \\node[state, below=of w97] (w98) {};\n        \\node[state, below=of w98] (w99) {};\n        \\node[state, below=of w99] (w100) {};\n        \\node[state, below=of w100] (w101) {};\n        \\node[state, below=of w101] (w102) {};\n        \\node[state, below=of w102] (w103) {};\n        \\node[state, below=of w103] (w104) {};\n        \\node[state, below=of w104] (w105) {};\n        \\node[state, below=of w105] (w106) {};\n        \\node[state, below=of w106] (w107) {};\n        \\node[state, below=of w107] (w108) {};\n        \\node[state, below=of w108] (w109) {};\n        \\node[state, below=of w109] (w110) {};\n        \\node[state, below=of w110] (w111) {};\n        \\node[state, below=of w111] (w112) {};\n        \\node[state, below=of w112] (w113) {};\n        \\node[state, below=of w113] (w114) {};\n        \\node[state, below=of w114] (w115) {};\n        \\node[state, below=of w115] (w116) {};\n        \\node[state, below=of w116] (w117) {};\n        \\node[state, below=of w117] (w118) {};\n        \\node[state, below=of w118] (w119) {};\n        \\node[state, below=of w119] (w120) {};\n        \\node[state, below=of w120] (w121) {};\n        \\node[state, below=of w121] (w122) {};\n        \\node[state, below=of w122] (w123) {};\n        \\node[state, below=of w123] (w124) {};\n        \\node[state, below=of w124] (w125) {};\n        \\node[state, below=of w125] (w126) {};\n        \\node[state, below=of w126] (w127) {};\n        \\node[state, below=of w127] (w128) {};\n        \\node[state, below=of w128] (w129) {};\n        \\node[state, below=of w129] (w130) {};\n        \\node[state, below=of w130] (w131) {};\n        \\node[state, below=of w131] (w132) {};\n        \\node[state, below=of w132] (w133) {};\n        \\node[state, below=of w133] (w134) {};\n        \\node[state, below=of w134] (w135) {};\n        \\node[state, below=of w135] (w136) {};\n        \\node[state, below=of w136] (w137) {};\n        \\node[state, below=of w137] (w138) {};\n        \\node[state, below=of w138] (w139) {};\n        \\node[state, below=of w139] (w140) {};\n        \\node[state, below=of w140] (w141) {};\n        \\node[state, below=of w141] (w142) {};\n        \\node[state, below=of w142] (w143) {};\n        \\node[state, below=of w143] (w144) {};\n        \\node[state, below=of w144] (w145) {};\n        \\node[state, below=of w145] (w146) {};\n        \\node[state, below=of w146] (w147) {};\n        \\node[state, below=of w147] (w148) {};\n        \\node[state, below=of w148] (w149) {};\n        \\node[state, below=of w149] (w150) {};\n        \\node[state, below=of w150] (w151) {};\n        \\node[state, below=of w151] (w152) {};\n        \\node[state, below=of w152] (w153) {};\n        \\node[state, below=of w153] (w154) {};\n        \\node[state, below=of w154] (w155) {};\n        \\node[state, below=of w155] (w156) {};\n        \\node[state, below=of w156] (w157) {};\n        \\node[state, below=of w157] (w158) {};\n        \\node[state, below=of w158] (w159) {};\n        \\node[state, below=of w159] (w160) {};\n        \\node[state, below=of w160] (w161) {};\n        \\node[state, below=of w161] (w162) {};\n        \\node[state, below=of w162] (w163) {};\n        \\node[state, below=of w163] (w164) {};\n        \\node[state, below=of w164] (w165) {};\n        \\node[state, below=of w165] (w166) {};\n        \\node[state, below=of w166] (w167) {};\n        \\node[state, below=of w167] (w168) {};\n        \\node[state, below=of w168] (w169) {};\n        \\node[state, below=of w169] (w170) {};\n        \\node[state, below=of w170] (w171) {};\n        \\node[state, below=of w171] (w172) {};\n        \\node[state, below=of w172] (w173) {};\n        \\node[state, below=of w173] (w174) {};\n        \\node[state, below=of w174] (w175) {};\n        \\node[state, below=of w175] (w176) {};\n        \\node[state, below=of w176] (w177) {};\n        \\node[state, below=of w177] (w178) {};\n        \\node[state, below=of w178] (w179) {};\n        \\node[state, below=of w179] (w180) {};\n        \\node[state, below=of w180] (w181) {};\n        \\node[state, below=of w181] (w182) {};\n        \\node[state, below=of w182] (w183) {};\n        \\node[state, below=of w183] (w184) {};\n        \\node[state, below=of w184] (w185) {};\n        \\node[state, below=of w185] (w186) {};\n        \\node[state, below=of w186] (w187) {};\n        \\node[state, below=of w187] (w188) {};\n        \\node[state, below=of w188] (w189) {};\n        \\node[state, below=of w189] (w190) {};\n        \\node[state, below=of w190] (w191) {};\n        \\node[state, below=of w191] (w192) {};\n        \\node[state, below=of w192] (w193",
  "ground_truth": "\\documentclass{article}\n\\usepackage{hyperref,amsmath,amssymb}\n\\usepackage{tikz,comment}\n\\usetikzlibrary{automata, arrows.meta, positioning,decorations.pathmorphing}\n\n\\begin{document}\n\n\\begin{tikzpicture}\n\t\\node[draw, circle] (s) at (0,0) {$p$};\n\t\n\t% s backward tree\n\t\\node[draw] (b1) at (0,-1) {$L_1$};\n\t\\node[draw] (b2) at (0,-2) {$\\quad L_2\\quad$};\n\t\\node (dots1) at (0,-3) {$\\vdots$};\n\t\\node[draw,blue] (btau) at (0,-4) {$\\ |L_h|\\in\\Theta(\\sqrt{n})\\ $};\n\n\t\\draw[->] (.2,-0.7) -- (.1,-0.3);\n\t\\draw[->] (-.2,-0.7) -- (-.1,-0.3);\n\t\n\t\\draw[->] (0,-1.7) -- (0,-1.3);\n\t\\draw[->] (-.5,-1.7) -- (-.2,-1.3);\n\t\\draw[->] (.5,-1.7) -- (.3,-1.3);\n\n\t\\draw[->] (-.25,-2.7) -- (-.15,-2.3);\n\t\\draw[->] (.25,-2.7) -- (.15,-2.3);\n\t\\draw[->] (-.6,-2.7) -- (-.4,-2.3);\n\t\\draw[->] (.6,-2.7) -- (.4,-2.3);\n\t\n\t\\draw[->] (0,-3.7) -- (0,-3.3);\n\t\\draw[->] (-.4,-3.7) -- (-.2,-3.3);\n\t\\draw[->] (.4,-3.7) -- (.3,-3.3);\n\t\\draw[->] (-.9,-3.7) -- (-.7,-3.3);\n\t\\draw[->] (.9,-3.7) -- (.7,-3.3);\n\n    \t\\draw[thin,<->,purple] (-1.6,-4.23) -- node[rotate=90,fill=white]{\\footnotesize $h$-backward substructure} (-1.6,0.23);\n\n\t% r forward tree\n\t\\node[draw,circle] (r) at (3,-2) {$r$};\n\t\\draw[->] (s) -- node[above]{$a$} (r);\n\t\\node(ra) at (2.6, -2.7) {$\\bullet$}; \\draw[->,shorten >=-3pt] (r) -- node[right]{\\tiny $a$} (ra);\n\t\\node (rb) at (3.4, -2.7) {$\\bullet$}; \\draw[->,shorten >=-3pt] (r) -- node[right]{\\tiny $b$} (rb);\n\t\\node (raa) at (2.4, -3.4) {$\\bullet$}; \\draw[->,shorten >=-3pt] (ra) -- node[left]{\\tiny $a$} (raa);\n\t\\node (rab) at (2.8, -3.4) {$\\bullet$}; \\draw[->,shorten >=-3pt] (ra) -- node[right]{\\tiny $b$} (rab);\n\t\\node (rba) at (3.2, -3.4) {$\\bullet$}; \\draw[->,shorten >=-3pt] (rb) -- node[left]{\\tiny $a$} (rba);\n\t\\node (rbb) at (3.6, -3.4) {$\\bullet$}; \\draw[->,shorten >=-3pt] (rb) -- node[right]{\\tiny $b$} (rbb);\n\t\\node (raaa) at (2.2, -4.1) {$\\bullet$}; \\draw[->,shorten >=-3pt] (raa) -- node[left]{\\tiny $a$} (raaa);\n\t\\draw[blue,->]  (raa) edge[bend left=120] node[below]{$b$} (btau);\n\n\t\\draw[thin,<->,purple] (4,-4.23) -- node[rotate=90,fill=white]{\\footnotesize forward tree} (4,-1.77);\n\n\t% added transition\n\t\\node[draw,circle] (t) at (5,0) {$q$};\n\t\\draw[->,red] (s) -- node[above]{$a$} (t);\n\n\t\\node[draw,circle] (s1) at (7,0) {\\footnotesize $p_1$};\n\t\\draw[->,thick,green!50!black,decorate,decoration={snake,amplitude=.4mm,segment length=2mm,post length=1mm}] (t) -- node[above]{$w$} (s1);\n\n\t\\node[draw,circle] (s2) at (9,0) {\\footnotesize $p_2$};\n\t\\draw[->,thick, green!50!black,decorate,decoration={snake,amplitude=.4mm,segment length=2mm,post length=1mm}] (s1) -- node[above]{${\\color{black}a}w$} (s2);\n\n\t\\draw[->,green!50!black, thick,decorate,decoration={snake,amplitude=.4mm,segment length=2mm,post length=1mm}] (2.8,-2.2) .. controls (1.3,-4.2) and  (.4,-.6) .. node[right]{$w$} (.3,-.4);\n\t\n\t\\node (p01) at (5,-1) {$\\bullet$}; \\draw[->] (s) -- node[above]{\\footnotesize $b$} (p01);\n\t\\node (p02) at (5,-1.7) {$\\bullet$}; \\draw[->] (p01) -- node[left]{\\footnotesize $b$} (p02);\n\t\\node (p03) at (5,-2.4) {$\\bullet$}; \\draw[->] (p02) -- node[left]{\\footnotesize $b$} (p03);\n\t\\node (p04) at (5,-3.1) {$\\bullet$}; \\draw[->] (p03) -- node[left]{\\footnotesize $b$} (p04);\n\t\\node (p0n) at (5,-4) {$\\bullet$}; \\draw[->,dotted] (p04) -- (p0n);\n\t\\draw[->] (p0n) edge[bend right=25] node[right]{\\footnotesize $b$} (p01);\n\n\t\\node (p11) at (7,-1) {$\\bullet$}; \\draw[->] (s1) -- node[left]{\\footnotesize $b$} (p11);\n\t\\node (p12) at (7,-1.7) {$\\bullet$}; \\draw[->] (p11) -- node[left]{\\footnotesize $b$} (p12);\n\t\\node (p13) at (7,-2.4) {$\\bullet$}; \\draw[->] (p12) -- node[left]{\\footnotesize $b$} (p13);\n\t\\node (p14) at (7,-3.1) {$\\bullet$}; \\draw[->] (p13) -- node[left]{\\footnotesize $b$} (p14);\n\t\\node (p1n) at (7,-4) {$\\bullet$}; \\draw[->,dotted] (p14) -- (p1n);\n\t\\draw[->] (p1n) edge[bend right=25] node[right]{\\footnotesize $b$} (p13);\n\n\t\\node (p21) at (9,-1) {$\\bullet$}; \\draw[->] (s2) -- node[left]{\\footnotesize $b$} (p21);\n\t\\node (p22) at (9,-1.7) {$\\bullet$}; \\draw[->] (p21) -- node[left]{\\footnotesize $b$} (p22);\n\t\\node (p23) at (9,-2.4) {$\\bullet$}; \\draw[->] (p22) -- node[left]{\\footnotesize $b$} (p23);\n\t\\node (p24) at (9,-3.1) {$\\bullet$}; \\draw[->] (p23) -- node[left]{\\footnotesize $b$} (p24);\n\t\\node (p2n) at (9,-4) {$\\bullet$}; \\draw[->,dotted] (p24) -- (p2n);\n\t\\draw[->] (p2n) edge[bend right=25] node[right]{\\footnotesize $b$} (p22);\n\n\t\\draw[thin,<->,purple] (4.8,-4.4) -- node[fill=white]{\\footnotesize three $b$-threads} (9.4,-4.4);\n\n    \\node[purple] (text) at (.7,.8) {\\footnotesize the added random transition};\n    \\draw[purple, thin] (text.east) edge[->,bend left] (4,.1);\n\n\t\\end{tikzpicture}\n\n\\end{document}"
}