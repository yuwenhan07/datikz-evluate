To generate LaTeX code for the image and caption provided, you can use the `tikz` package along with some additional packages like `pgfplots` for drawing the graph and `amsmath` for mathematical expressions. Below is a sample LaTeX code that creates a similar diagram:

```latex
\documentclass{article}
\usepackage{amsmath}
\usepackage{tikz}
\usetikzlibrary{arrows.meta, decorations.pathmorphing, positioning, quotes}

\begin{document}

\begin{figure}[h]
    \centering
    \begin{tikzpicture}[node distance=1cm, auto,
        state/.style={circle, draw, minimum size=0.5cm},
        leaf/.style={circle, fill, inner sep=1pt},
        arrow/.style={-{Stealth[scale=1.5]}, thick},
        dashed arrow/.style={-{Stealth[scale=1.5]}, dashed, thick},
        green arrow/.style={-{Stealth[scale=1.5]}, green, thick},
        blue arrow/.style={-{Stealth[scale=1.5]}, blue, thick},
        red arrow/.style={-{Stealth[scale=1.5]}, red, thick},
        dotted arrow/.style={-{Stealth[scale=1.5]}, dotted, thick},
        ]

        % Nodes
        \node[state] (p) {$p$};
        \node[state, below=of p] (L1) {$L_1$};
        \node[state, below=of L1] (L2) {$L_2$};
        \node[state, below=of L2] (dots) {$\vdots$};
        \node[state, below=of dots] (Lh) {$[L_h]\in\Theta(\sqrt{n})$};
        \node[state, right=3cm of p] (q) {$q$};
        \node[state, right=3cm of q] (p1) {$p_1$};
        \node[state, right=3cm of p1] (p2) {$p_2$};
        \node[state, below=of p1] (w1) {};
        \node[state, below=of w1] (w2) {};
        \node[state, below=of w2] (w3) {};
        \node[state, below=of w3] (w4) {};
        \node[state, below=of w4] (w5) {};
        \node[state, below=of w5] (w6) {};
        \node[state, below=of w6] (w7) {};
        \node[state, below=of w7] (w8) {};
        \node[state, below=of w8] (w9) {};
        \node[state, below=of w9] (w10) {};
        \node[state, below=of w10] (w11) {};
        \node[state, below=of w11] (w12) {};
        \node[state, below=of w12] (w13) {};
        \node[state, below=of w13] (w14) {};
        \node[state, below=of w14] (w15) {};
        \node[state, below=of w15] (w16) {};
        \node[state, below=of w16] (w17) {};
        \node[state, below=of w17] (w18) {};
        \node[state, below=of w18] (w19) {};
        \node[state, below=of w19] (w20) {};
        \node[state, below=of w20] (w21) {};
        \node[state, below=of w21] (w22) {};
        \node[state, below=of w22] (w23) {};
        \node[state, below=of w23] (w24) {};
        \node[state, below=of w24] (w25) {};
        \node[state, below=of w25] (w26) {};
        \node[state, below=of w26] (w27) {};
        \node[state, below=of w27] (w28) {};
        \node[state, below=of w28] (w29) {};
        \node[state, below=of w29] (w30) {};
        \node[state, below=of w30] (w31) {};
        \node[state, below=of w31] (w32) {};
        \node[state, below=of w32] (w33) {};
        \node[state, below=of w33] (w34) {};
        \node[state, below=of w34] (w35) {};
        \node[state, below=of w35] (w36) {};
        \node[state, below=of w36] (w37) {};
        \node[state, below=of w37] (w38) {};
        \node[state, below=of w38] (w39) {};
        \node[state, below=of w39] (w40) {};
        \node[state, below=of w40] (w41) {};
        \node[state, below=of w41] (w42) {};
        \node[state, below=of w42] (w43) {};
        \node[state, below=of w43] (w44) {};
        \node[state, below=of w44] (w45) {};
        \node[state, below=of w45] (w46) {};
        \node[state, below=of w46] (w47) {};
        \node[state, below=of w47] (w48) {};
        \node[state, below=of w48] (w49) {};
        \node[state, below=of w49] (w50) {};
        \node[state, below=of w50] (w51) {};
        \node[state, below=of w51] (w52) {};
        \node[state, below=of w52] (w53) {};
        \node[state, below=of w53] (w54) {};
        \node[state, below=of w54] (w55) {};
        \node[state, below=of w55] (w56) {};
        \node[state, below=of w56] (w57) {};
        \node[state, below=of w57] (w58) {};
        \node[state, below=of w58] (w59) {};
        \node[state, below=of w59] (w60) {};
        \node[state, below=of w60] (w61) {};
        \node[state, below=of w61] (w62) {};
        \node[state, below=of w62] (w63) {};
        \node[state, below=of w63] (w64) {};
        \node[state, below=of w64] (w65) {};
        \node[state, below=of w65] (w66) {};
        \node[state, below=of w66] (w67) {};
        \node[state, below=of w67] (w68) {};
        \node[state, below=of w68] (w69) {};
        \node[state, below=of w69] (w70) {};
        \node[state, below=of w70] (w71) {};
        \node[state, below=of w71] (w72) {};
        \node[state, below=of w72] (w73) {};
        \node[state, below=of w73] (w74) {};
        \node[state, below=of w74] (w75) {};
        \node[state, below=of w75] (w76) {};
        \node[state, below=of w76] (w77) {};
        \node[state, below=of w77] (w78) {};
        \node[state, below=of w78] (w79) {};
        \node[state, below=of w79] (w80) {};
        \node[state, below=of w80] (w81) {};
        \node[state, below=of w81] (w82) {};
        \node[state, below=of w82] (w83) {};
        \node[state, below=of w83] (w84) {};
        \node[state, below=of w84] (w85) {};
        \node[state, below=of w85] (w86) {};
        \node[state, below=of w86] (w87) {};
        \node[state, below=of w87] (w88) {};
        \node[state, below=of w88] (w89) {};
        \node[state, below=of w89] (w90) {};
        \node[state, below=of w90] (w91) {};
        \node[state, below=of w91] (w92) {};
        \node[state, below=of w92] (w93) {};
        \node[state, below=of w93] (w94) {};
        \node[state, below=of w94] (w95) {};
        \node[state, below=of w95] (w96) {};
        \node[state, below=of w96] (w97) {};
        \node[state, below=of w97] (w98) {};
        \node[state, below=of w98] (w99) {};
        \node[state, below=of w99] (w100) {};
        \node[state, below=of w100] (w101) {};
        \node[state, below=of w101] (w102) {};
        \node[state, below=of w102] (w103) {};
        \node[state, below=of w103] (w104) {};
        \node[state, below=of w104] (w105) {};
        \node[state, below=of w105] (w106) {};
        \node[state, below=of w106] (w107) {};
        \node[state, below=of w107] (w108) {};
        \node[state, below=of w108] (w109) {};
        \node[state, below=of w109] (w110) {};
        \node[state, below=of w110] (w111) {};
        \node[state, below=of w111] (w112) {};
        \node[state, below=of w112] (w113) {};
        \node[state, below=of w113] (w114) {};
        \node[state, below=of w114] (w115) {};
        \node[state, below=of w115] (w116) {};
        \node[state, below=of w116] (w117) {};
        \node[state, below=of w117] (w118) {};
        \node[state, below=of w118] (w119) {};
        \node[state, below=of w119] (w120) {};
        \node[state, below=of w120] (w121) {};
        \node[state, below=of w121] (w122) {};
        \node[state, below=of w122] (w123) {};
        \node[state, below=of w123] (w124) {};
        \node[state, below=of w124] (w125) {};
        \node[state, below=of w125] (w126) {};
        \node[state, below=of w126] (w127) {};
        \node[state, below=of w127] (w128) {};
        \node[state, below=of w128] (w129) {};
        \node[state, below=of w129] (w130) {};
        \node[state, below=of w130] (w131) {};
        \node[state, below=of w131] (w132) {};
        \node[state, below=of w132] (w133) {};
        \node[state, below=of w133] (w134) {};
        \node[state, below=of w134] (w135) {};
        \node[state, below=of w135] (w136) {};
        \node[state, below=of w136] (w137) {};
        \node[state, below=of w137] (w138) {};
        \node[state, below=of w138] (w139) {};
        \node[state, below=of w139] (w140) {};
        \node[state, below=of w140] (w141) {};
        \node[state, below=of w141] (w142) {};
        \node[state, below=of w142] (w143) {};
        \node[state, below=of w143] (w144) {};
        \node[state, below=of w144] (w145) {};
        \node[state, below=of w145] (w146) {};
        \node[state, below=of w146] (w147) {};
        \node[state, below=of w147] (w148) {};
        \node[state, below=of w148] (w149) {};
        \node[state, below=of w149] (w150) {};
        \node[state, below=of w150] (w151) {};
        \node[state, below=of w151] (w152) {};
        \node[state, below=of w152] (w153) {};
        \node[state, below=of w153] (w154) {};
        \node[state, below=of w154] (w155) {};
        \node[state, below=of w155] (w156) {};
        \node[state, below=of w156] (w157) {};
        \node[state, below=of w157] (w158) {};
        \node[state, below=of w158] (w159) {};
        \node[state, below=of w159] (w160) {};
        \node[state, below=of w160] (w161) {};
        \node[state, below=of w161] (w162) {};
        \node[state, below=of w162] (w163) {};
        \node[state, below=of w163] (w164) {};
        \node[state, below=of w164] (w165) {};
        \node[state, below=of w165] (w166) {};
        \node[state, below=of w166] (w167) {};
        \node[state, below=of w167] (w168) {};
        \node[state, below=of w168] (w169) {};
        \node[state, below=of w169] (w170) {};
        \node[state, below=of w170] (w171) {};
        \node[state, below=of w171] (w172) {};
        \node[state, below=of w172] (w173) {};
        \node[state, below=of w173] (w174) {};
        \node[state, below=of w174] (w175) {};
        \node[state, below=of w175] (w176) {};
        \node[state, below=of w176] (w177) {};
        \node[state, below=of w177] (w178) {};
        \node[state, below=of w178] (w179) {};
        \node[state, below=of w179] (w180) {};
        \node[state, below=of w180] (w181) {};
        \node[state, below=of w181] (w182) {};
        \node[state, below=of w182] (w183) {};
        \node[state, below=of w183] (w184) {};
        \node[state, below=of w184] (w185) {};
        \node[state, below=of w185] (w186) {};
        \node[state, below=of w186] (w187) {};
        \node[state, below=of w187] (w188) {};
        \node[state, below=of w188] (w189) {};
        \node[state, below=of w189] (w190) {};
        \node[state, below=of w190] (w191) {};
        \node[state, below=of w191] (w192) {};
        \node[state, below=of w192] (w193